
v 1.8.5

_FO_FileSearch - функция поиска файлов
_FO_FolderSearch - функция поиска папок
_FO_CorrectMask - функция корректирующая маску
_FO_SearchEmptyFolders - функция поиска пустых папок
_FO_FileDirReName - функция переименования файла
_FO_GetCopyName - функция вычисления нового имени копии файла, несуществующего
_FO_FileBackup - функция создаёт резервную копию файла
_FO_PathSplit - функция делит путь на 3 части в массив
_FO_IsDir - функция проверяет, является ли объект каталогом или файлом.
_FO_IsEmptyFolder - проверяет, является ли папка пуста
_FO_ShortFileSize - Преобразует байты в число, до 3 значащих цифр с приставкой
_FO_CreateFile - Создаёт файл

===============================================
--	Описание	--
Проверяет валидность пути, маски. Содержит основные опции: маска, исключения (инвертирование маски), вложенность. Второстепенные параметры функции: формат возвращаемых данных (массив или список), полные, относительные пути или только имена файлов. Любая ошибка сопровождается кодом ошибки и возвратом пустой строки, и наоборот отсутствие ошибки возвращает валидные данные. В комплекте пример и Gui для теста. Отличие Ru от En только в русских комментариях к функции. Максимальная вложенность $Depth = 125 проверена экспериментальным путём, скриптом создал вложенные папки в качестве имени использовал один символ, их оказалось около 123 для запаса использую 125 (путь не превышает 256 символов, отсюда ограничение). В комплекте "Corrects Mask (viewing).au3" для просмотра работы функции корреции маски. Коррекция предназначена для исправления ошибок ввода от пользователя, тем самым упрощая регулярное выражение, скорость работы которого зависит от содержания.
Регулярное выражение содержит флаг не учитывать регистр, но работает это только для символов латинского алфавита.

Правильность маски и поведение поиска.
1. Удаляются повтор элементов маски. Например *.avi|*.mpg|*.avi оставит *.avi|*.mpg (влияет только на скорость регулярного выражения)
2. Маска такого вида *|*.avi обработает как * - все файлы, по наибольшему захвату
3. Пустая строка маски тоже что и * - поиск всех файлов
4. Повотры пробелов и точек в конце каждого элемента маски удаляются, то есть *.avi .|*.mpg |*.vob. то же что *.avi|*.mpg|*.vob
5. Символы * - любое множество или отсутствие символов, ? - любой одиночный символ. При чём поиск не аналогичен поиску в эксплорере, где изначально маcка задана так: *mask*, то есть любое имя содержащее mask

===============================================
Ресурсы, на которых можно найти последние версии функции

http://www.autoitscript.com/forum/topic/133224-filesearch-foldersearch/

http://pastebin.com/AbzMyg1x
http://pastebin.com/H7F2svZe
http://pastebin.com/Rpv6tqiq

http://u.to/MplKAQ

===============================================
Обновления

2014.05.26
Упрощение _FO_CreateFile

2014.05.24
Добавлена функция _FO_CreateFile

2014.03.18
Обновлена _FO_IsEmptyFolder

2013.09.04
Улучшение регулярных выражений, оптимизации

2013.08.02
Добавлено _FO_IsEmptyFolder
Удалена проблема с AU3Check

2013.06.15
Добавлено _FO_ShortFileSize
В функцию поиска файлов добавлены два параметра для исключения каталога из поиска
Улучшен параметр чуствительности к регистру, не требует указывать диапазон

2013.04.28
Поиск пустых папок теперь выдаёт ошибку при указании файла вместо папки

2013.04.27
Исправлено, если путь пустая строка, это не вызывало ошибки

2013.01.03
Удалены $i из объявления, так как они для цикла For принудительно локальные.
Tidy

2012.11.20
Добавлена функция _FO_IsDir
Добавлен CHM-файл с описанием

2012.08.08
Улучшен параметр учёта регистра
Текст локализации _FO_GetCopyName вынесен в опциональный передаваемый параметр

2012.06.09
Добавлена функция __FO_UserLocale, чтобы не учитывать регистр букв для локального языка.

2012.05.20
В функцию _FO_SearchEmptyFolders добавлен параметр $iFull - полный или относительный путь

2012.05.19
Добавлены две функции _FO_FileBackup, _FO_PathSplit

2012.05.14
Добавлены две функции _FO_FileDirReName и _FO_GetCopyName

2012.02.22
Улучшен Gui_Test_Search.au3 для с готовым выбором путей для тестирования
Использовавние ByRef увеличило скорость на 2.5%

2012.02.21
Присвоение символа "\" поставил до проверки пути, теперь путь к файлу не будет валидным

2012.02.16
Для избавления от возможных конфликтов аналогичных одноимённых функций других скриптёров AutoIt3, к функции добавлен префикс _FO
UDF названа FileOperations.au3
Добавлена функция _FO_SearchEmptyFolders - поиск пустых папок

2012.02.15
Убрал лишнюю объявленную переменную $i найденную с помощью Au3Check (не критично)
Для избавления проблем обфускации функция __MaskUnique добавлена в исключение директивами #Obfuscator_Off и #Obfuscator_On
Добавлены префиксы типов переменных

2012.01.10
Коррекция маски выведена в отдельную функцию _FO_CorrectMask
Добавлена проверка уникальности элементов маски

2011.11.27
Всвязи с тем что некоторые программы (в отличии от эксплорера) позволяют переименование файла с добавлением пробела или точки в начало имени, то функция не корректирует маску по этому критерию, то есть корректирует только в отношении окончания файла.
Исправлены некритические ошибки

2011.11.9
Символ разделителя ";" заменён на "|", по причине, что ";" может присутствовать в именах файлов, а значит в маске, что не должно препятствовать поиску. В случае конфликта с разделителем в скрипте можно использовать Opt("GUIDataSeparatorChar", Chr(1)) или использовать свой разделитель, а при передаче опций в функцию сделать замену разделителя в маске, например _FO_FileSearch($Path, StringReplace($Mask, ';', '|'))
Изменён порядок проверки валидности маски для наилучшего детектирования и/или исправления ошибок маски

2011.10.24
Исправлена ошибка при комбинайии Full=3 и Arr=1
Увеличена в 2 раза скорость работы _FO_FolderSearch

2011.10.22
Исправлен возврат функции __GetListMask

2011.10.17
Добавлен параметр $TypeMask с принудительной опцией маски

2011.10.15
Добавлен возврат ошибки @error = 3 - если не найдено файлов (кстати, спорный параметр, так как не найденность не является ошибкой а только отсутсвием результа, что является тоже результатом. В любом случае есть 2 варианта - программы, в которых отсутствие результата является ошибкой, так как нет смысла в дальнейшей обработке данных и программы, в которых отсутствие результата не вызывает проблем и затрат, обычное присоединение данных к предыдущему результату без обработки ошибок)

2011.10.14
Добавлен параметр $Include = True/False в функцию _FO_FolderSearch


2011.10.12
Исправление функции  __FO_FileSearchMask

2011.10.10
Исправлено $Include=False, когда файлы без расширения не попадали в список исключений
Добавлена функция маски с обработкой регулярным выражением

===============================================
Планы
1. Возможно добавить строку If $Depth = -1 Then $Depth = 125 что избавит от установки числа 125 и устранит сомнения и желание выставить $Depth = 10000000
2. Проверить работу с сетевым диском... Пока что маска пути препятствует этому.

===============================================
Данная UDF используется в моих проектах - TextReplace, Create_list_files, Search_duplicates, contmenu, ReName. В последних указанных старая версия функции, а в ReName ещё и встроена внутри с небольшой модернизацией для возврата количества сделанных шагов поиска.